generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  email    String   @unique
  id       Int      @default(autoincrement()) @id
  name     String
  password String
  isAdmin  Boolean  @default(false)
  players  Player[]
}

model Game {
  id         Int      @default(autoincrement()) @id
  name       String 
  state      Boolean  @default(true)
  startTurns Int      @default(10)
  startLand  Int      @default(100)
  safeTurns  Int      @default(100)
  turnTime   Int      @default(600)
  turnsDone  Int      @default(0)
  gameDone   Int      @default(4320)
  players    Player[]
  Turn       Turn[]
}

model Player {
  id             Int    @default(autoincrement()) @id
  name           String
  user           User   @relation(fields: [userId], references: [id])
  userId         Int
  game           Game   @relation(fields: [gameId], references: [id])
  gameId         Int
  availableTurns Int
  currentTurn    Turn?   @relation(name: "CurrentTurn", fields: [currentTurnId], references: [id])
  currentTurnId  Int?
  completedTurns Turn[]
  @@unique([name, gameId])
}

model Turn {
  id              Int      @default(autoincrement()) @id
  player          Player   @relation(fields: [playerId], references: [id])
  playerId        Int
  game            Game     @relation(fields: [gameId], references: [id])
  gameId          Int
  createdAt       DateTime @default(now())
  completedAt     DateTime
  money           Float?   @default(0)
  food            Int?     @default(0)
  population      Int?     @default(0)
  taxRate         Float?   @default(0)
  landAvail       Int?     @default(0)
  landCoastal     Int?     @default(0)
  landCity        Int?     @default(0)
  landAgriculture Int?     @default(0)
  landIndustrial  Int?     @default(0)
  armyTroopers    Int?     @default(0)
  armyTurrets     Int?     @default(0)
  armyBombers     Int?     @default(0)
  armyTanks       Int?     @default(0)
  armyCarriers    Int?     @default(0)
  genTroopers     Int?     @default(0)
  genTurrents     Int?     @default(0)
  genBombers      Int?     @default(0)
  genTanks        Int?     @default(0)
  genCarriers     Int?     @default(0)
  Player          Player[] @relation("CurrentTurn")
}